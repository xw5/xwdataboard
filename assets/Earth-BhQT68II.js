var P=Object.defineProperty;var A=(n,t,e)=>t in n?P(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var i=(n,t,e)=>(A(n,typeof t!="symbol"?t+"":t,e),e);import{_ as I,r as g,j,i as v,e as p,n as B,E as H,t as C,A as $,f as F,d as q,B as U,o as y,F as N,D as V,p as G,g as J,u as Q,Q as z,R as M,S as X,T as Y}from"./index-Bv4DOqsS.js";import{D as K}from"./DialogMain-Bqe4HJQF.js";function S(n){return Math.abs(Math.floor(n))}function f(n,t){return Math.random()*(t-n)+n}function c(n,t){return Math.floor(f(n,t+1))}function O(n,t,e,s){const o=Math.pow;return Math.sqrt(o(n-e,2)+o(t-s,2))}function k(n,t,e=1){if(n>360||n<0)throw new Error(`Expected hue 0-360 range, got \`${n}\``);if(t>100||t<0)throw new Error(`Expected lightness 0-100 range, got \`${t}\``);if(e>1||e<0)throw new Error(`Expected alpha 0-1 range, got \`${e}\``);return`hsla(${n}, 100%, ${t}%, ${e})`}const L=n=>{if(typeof n=="object"&&n!==null){if(typeof Object.getPrototypeOf=="function"){const t=Object.getPrototypeOf(n);return t===Object.prototype||t===null}return Object.prototype.toString.call(n)==="[object Object]"}return!1},Z=["__proto__","constructor","prototype"],T=(...n)=>n.reduce((t,e)=>(Object.keys(e).forEach(s=>{Z.includes(s)||(Array.isArray(t[s])&&Array.isArray(e[s])?t[s]=e[s]:L(t[s])&&L(e[s])?t[s]=T(t[s],e[s]):t[s]=e[s])}),t),{});function tt(n,t){let e;return(...s)=>{e&&clearTimeout(e),e=setTimeout(()=>n(...s),t)}}class it{constructor({x:t,y:e,ctx:s,hue:o,decay:a,gravity:r,friction:h,brightness:u,flickering:l,lineWidth:d,explosionLength:x}){i(this,"x");i(this,"y");i(this,"ctx");i(this,"hue");i(this,"friction");i(this,"gravity");i(this,"flickering");i(this,"lineWidth");i(this,"explosionLength");i(this,"angle");i(this,"speed");i(this,"brightness");i(this,"coordinates",[]);i(this,"decay");i(this,"alpha",1);for(this.x=t,this.y=e,this.ctx=s,this.hue=o,this.gravity=r,this.friction=h,this.flickering=l,this.lineWidth=d,this.explosionLength=x,this.angle=f(0,Math.PI*2),this.speed=c(1,10),this.brightness=c(u.min,u.max),this.decay=f(a.min,a.max);this.explosionLength--;)this.coordinates.push([t,e])}update(t){this.coordinates.pop(),this.coordinates.unshift([this.x,this.y]),this.speed*=this.friction,this.x+=Math.cos(this.angle)*this.speed,this.y+=Math.sin(this.angle)*this.speed+this.gravity,this.alpha-=this.decay,this.alpha<=this.decay&&t()}draw(){const t=this.coordinates.length-1;this.ctx.beginPath(),this.ctx.lineWidth=this.lineWidth,this.ctx.fillStyle=k(this.hue,this.brightness,this.alpha),this.ctx.moveTo(this.coordinates[t][0],this.coordinates[t][1]),this.ctx.lineTo(this.x,this.y),this.ctx.strokeStyle=k(this.hue,this.flickering?f(0,this.brightness):this.brightness,this.alpha),this.ctx.stroke()}}class et{constructor(t,e){i(this,"active",!1);i(this,"x");i(this,"y");this.options=t,this.canvas=e,this.pointerDown=this.pointerDown.bind(this),this.pointerUp=this.pointerUp.bind(this),this.pointerMove=this.pointerMove.bind(this)}get mouseOptions(){return this.options.mouse}mount(){this.canvas.addEventListener("pointerdown",this.pointerDown),this.canvas.addEventListener("pointerup",this.pointerUp),this.canvas.addEventListener("pointermove",this.pointerMove)}unmount(){this.canvas.removeEventListener("pointerdown",this.pointerDown),this.canvas.removeEventListener("pointerup",this.pointerUp),this.canvas.removeEventListener("pointermove",this.pointerMove)}usePointer(t,e){const{click:s,move:o}=this.mouseOptions;(s||o)&&(this.x=t.pageX-this.canvas.offsetLeft,this.y=t.pageY-this.canvas.offsetTop,this.active=e)}pointerDown(t){this.usePointer(t,this.mouseOptions.click)}pointerUp(t){this.usePointer(t,!1)}pointerMove(t){this.usePointer(t,this.active)}}class st{constructor(){i(this,"hue");i(this,"rocketsPoint");i(this,"opacity");i(this,"acceleration");i(this,"friction");i(this,"gravity");i(this,"particles");i(this,"explosion");i(this,"mouse");i(this,"boundaries");i(this,"sound");i(this,"delay");i(this,"brightness");i(this,"decay");i(this,"flickering");i(this,"intensity");i(this,"traceLength");i(this,"traceSpeed");i(this,"lineWidth");i(this,"lineStyle");i(this,"autoresize");this.autoresize=!0,this.lineStyle="round",this.flickering=50,this.traceLength=3,this.traceSpeed=10,this.intensity=30,this.explosion=5,this.gravity=1.5,this.opacity=.5,this.particles=50,this.friction=.95,this.acceleration=1.05,this.hue={min:0,max:360},this.rocketsPoint={min:50,max:50},this.lineWidth={explosion:{min:1,max:3},trace:{min:1,max:2}},this.mouse={click:!1,move:!1,max:1},this.delay={min:30,max:60},this.brightness={min:50,max:80},this.decay={min:.015,max:.03},this.sound={enabled:!1,files:["explosion0.mp3","explosion1.mp3","explosion2.mp3"],volume:{min:4,max:8}},this.boundaries={debug:!1,height:0,width:0,x:50,y:50}}update(t){Object.assign(this,T(this,t))}}class nt{constructor(t,e){i(this,"tick",0);i(this,"rafId",0);i(this,"fps",60);i(this,"tolerance",.1);i(this,"now");this.options=t,this.render=e}mount(){this.now=performance.now();const t=1e3/this.fps,e=s=>{this.rafId=requestAnimationFrame(e);const o=s-this.now;o>=t-this.tolerance&&(this.render(),this.now=s-o%t,this.tick+=o*(this.options.intensity*Math.PI)/1e3)};this.rafId=requestAnimationFrame(e)}unmount(){cancelAnimationFrame(this.rafId)}}class ot{constructor(t,e,s){i(this,"resizer");this.options=t,this.updateSize=e,this.container=s}mount(){if(!this.resizer){const t=tt(()=>this.updateSize(),100);this.resizer=new ResizeObserver(t)}this.options.autoresize&&this.resizer.observe(this.container)}unmount(){this.resizer&&this.resizer.unobserve(this.container)}}class ht{constructor(t){i(this,"buffers",[]);i(this,"audioContext");i(this,"onInit",!1);this.options=t,this.init()}get isEnabled(){return this.options.sound.enabled}get soundOptions(){return this.options.sound}init(){!this.onInit&&this.isEnabled&&(this.onInit=!0,this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.loadSounds())}async loadSounds(){for(const t of this.soundOptions.files){const e=await(await fetch(t)).arrayBuffer();this.audioContext.decodeAudioData(e).then(s=>{this.buffers.push(s)}).catch(s=>{throw s})}}play(){if(this.isEnabled&&this.buffers.length){const t=this.audioContext.createBufferSource(),e=this.buffers[c(0,this.buffers.length-1)],s=this.audioContext.createGain();t.buffer=e,s.gain.value=f(this.soundOptions.volume.min/100,this.soundOptions.volume.max/100),s.connect(this.audioContext.destination),t.connect(s),t.start(0)}else this.init()}}class at{constructor({x:t,y:e,dx:s,dy:o,ctx:a,hue:r,speed:h,traceLength:u,acceleration:l}){i(this,"x");i(this,"y");i(this,"sx");i(this,"sy");i(this,"dx");i(this,"dy");i(this,"ctx");i(this,"hue");i(this,"speed");i(this,"acceleration");i(this,"traceLength");i(this,"totalDistance");i(this,"angle");i(this,"brightness");i(this,"coordinates",[]);i(this,"currentDistance",0);for(this.x=t,this.y=e,this.sx=t,this.sy=e,this.dx=s,this.dy=o,this.ctx=a,this.hue=r,this.speed=h,this.traceLength=u,this.acceleration=l,this.totalDistance=O(t,e,s,o),this.angle=Math.atan2(o-e,s-t),this.brightness=c(50,70);this.traceLength--;)this.coordinates.push([t,e])}update(t){this.coordinates.pop(),this.coordinates.unshift([this.x,this.y]),this.speed*=this.acceleration;const e=Math.cos(this.angle)*this.speed,s=Math.sin(this.angle)*this.speed;this.currentDistance=O(this.sx,this.sy,this.x+e,this.y+s),this.currentDistance>=this.totalDistance?t(this.dx,this.dy,this.hue):(this.x+=e,this.y+=s)}draw(){const t=this.coordinates.length-1;this.ctx.beginPath(),this.ctx.moveTo(this.coordinates[t][0],this.coordinates[t][1]),this.ctx.lineTo(this.x,this.y),this.ctx.strokeStyle=k(this.hue,this.brightness),this.ctx.stroke()}}class rt{constructor(t,e={}){i(this,"target");i(this,"container");i(this,"canvas");i(this,"ctx");i(this,"width");i(this,"height");i(this,"traces",[]);i(this,"explosions",[]);i(this,"waitStopRaf");i(this,"running",!1);i(this,"opts");i(this,"sound");i(this,"resize");i(this,"mouse");i(this,"raf");this.target=t,this.container=t,this.opts=new st,this.createCanvas(this.target),this.updateOptions(e),this.sound=new ht(this.opts),this.resize=new ot(this.opts,this.updateSize.bind(this),this.container),this.mouse=new et(this.opts,this.canvas),this.raf=new nt(this.opts,this.render.bind(this))}get isRunning(){return this.running}get version(){return"2.10.7"}get currentOptions(){return this.opts}start(){this.running||(this.canvas.isConnected||this.createCanvas(this.target),this.running=!0,this.resize.mount(),this.mouse.mount(),this.raf.mount())}stop(t=!1){!this.running||(this.running=!1,this.resize.unmount(),this.mouse.unmount(),this.raf.unmount(),this.clear(),t&&this.canvas.remove())}async waitStop(t){if(this.running)return new Promise(e=>{this.waitStopRaf=()=>{!this.waitStopRaf||(requestAnimationFrame(this.waitStopRaf),!this.traces.length&&!this.explosions.length&&(this.waitStopRaf=null,this.stop(t),e()))},this.waitStopRaf()})}pause(){this.running=!this.running,this.running?this.raf.mount():this.raf.unmount()}clear(){!this.ctx||(this.traces=[],this.explosions=[],this.ctx.clearRect(0,0,this.width,this.height))}launch(t=1){for(let e=0;e<t;e++)this.createTrace();this.waitStopRaf||(this.start(),this.waitStop())}updateOptions(t){this.opts.update(t)}updateSize({width:t=this.container.clientWidth,height:e=this.container.clientHeight}={}){this.width=t,this.height=e,this.canvas.width=t,this.canvas.height=e,this.updateBoundaries({...this.opts.boundaries,width:t,height:e})}updateBoundaries(t){this.updateOptions({boundaries:t})}createCanvas(t){t instanceof HTMLCanvasElement?(t.isConnected||document.body.append(t),this.canvas=t):(this.canvas=document.createElement("canvas"),this.container.append(this.canvas)),this.ctx=this.canvas.getContext("2d"),this.updateSize()}render(){if(!this.ctx||!this.running)return;const{opacity:t,lineStyle:e,lineWidth:s}=this.opts;this.ctx.globalCompositeOperation="destination-out",this.ctx.fillStyle=`rgba(0, 0, 0, ${t})`,this.ctx.fillRect(0,0,this.width,this.height),this.ctx.globalCompositeOperation="lighter",this.ctx.lineCap=e,this.ctx.lineJoin="round",this.ctx.lineWidth=f(s.trace.min,s.trace.max),this.initTrace(),this.drawTrace(),this.drawExplosion()}createTrace(){const{hue:t,rocketsPoint:e,boundaries:s,traceLength:o,traceSpeed:a,acceleration:r,mouse:h}=this.opts;this.traces.push(new at({x:this.width*c(e.min,e.max)/100,y:this.height,dx:this.mouse.x&&h.move||this.mouse.active?this.mouse.x:c(s.x,s.width-s.x*2),dy:this.mouse.y&&h.move||this.mouse.active?this.mouse.y:c(s.y,s.height*.5),ctx:this.ctx,hue:c(t.min,t.max),speed:a,acceleration:r,traceLength:S(o)}))}initTrace(){if(this.waitStopRaf)return;const{delay:t,mouse:e}=this.opts;(this.raf.tick>c(t.min,t.max)||this.mouse.active&&e.max>this.traces.length)&&(this.createTrace(),this.raf.tick=0)}drawTrace(){let t=this.traces.length;for(;t--;)this.traces[t].draw(),this.traces[t].update((e,s,o)=>{this.initExplosion(e,s,o),this.sound.play(),this.traces.splice(t,1)})}initExplosion(t,e,s){const{particles:o,flickering:a,lineWidth:r,explosion:h,brightness:u,friction:l,gravity:d,decay:x}=this.opts;let b=S(o);for(;b--;)this.explosions.push(new it({x:t,y:e,ctx:this.ctx,hue:s,friction:l,gravity:d,flickering:c(0,100)<=a,lineWidth:f(r.explosion.min,r.explosion.max),explosionLength:S(h),brightness:u,decay:x}))}drawExplosion(){let t=this.explosions.length;for(;t--;)this.explosions[t].draw(),this.explosions[t].update(()=>{this.explosions.splice(t,1)})}}const _=n=>(G("data-v-8ad6e9d7"),n=n(),J(),n),ct={class:"w-full overflow-hidden relative h-screen"},lt=_(()=>p("p",{class:"w-full absolute left-0 top-[10px] flex items-center justify-center text-white text-[40px] max-[750px]:top-[.86rem] max-[750px]:text-[.42rem] text-center z-10"},[p("span",{class:"title"},"热爱和平，保护环境，共创和谐家园")],-1)),ut=_(()=>p("canvas",{class:"w-full h-full absolute top-0 left-0 z-[50] pointer-events-none",id:"fireWork"},null,-1)),pt={class:"w-full flex flex-col items-center"},dt=_(()=>p("h3",{class:"text-[20px] mb-[10px] font-bold"},"我有一个愿望",-1)),xt=["onClick"],gt={__name:"Earth",setup(n){const t=g(),e=Q();let s=null;const o=Y(),a=()=>{const w={backgroundColor:"#000",globe:{baseTexture:o==="mobile"?z:M,heightTexture:o==="mobile"?z:M,displacementScale:.04,shading:"realistic",environment:X,globeRadius:(window.innerWidth>window.innerHeight?window.innerHeight:window.innerWidth)/2*.16,realisticMaterial:{roughness:.9},devicePixelRatio:window.devicePixelRatio,viewControl:{autoRotate:!0,autoRotateSpeed:2.5},light:{main:{intensity:1.5,shadow:!0}}}};s=U(t.value),s.setOption(w,!0)},r=()=>{e.replace({name:"home"})},h=g(),u=g(["愿地球常绿，生态永存","绿水青山，守护家园","环保行动，共筑未来","珍爱自然，和谐共生","守护蓝天，呼吸清新","和平相伴，幸福常在","放下纷争，拥抱和平","放下武器，拥抱和平","和平之花，绽放人间","心中有爱，和平永驻"]),l=g(),d=g(!1),x=g(0),b=g(o==="mobile"),R=()=>{h.value.show()},W=w=>{l.value=w,h.value.hide(),d.value=!0,m.start(),setTimeout(()=>{d.value=!1,m.waitStop(!0)},2e3)};let m=null;return j(()=>{console.log("---- Earth onMounted ----:"),x.value=window.innerHeight,setTimeout(()=>{a(),window.addEventListener("resize",()=>{x.value=window.innerHeight,m.updateSize({w:window.innerWidth,h:window.innerHeight}),s.resize()})},100),m=new rt(document.querySelector("#fireWork"),{particles:100})}),(w,ft)=>(y(),v("div",ct,[lt,p("div",{class:"w-full h-full overflow-hidden earth-container",ref_key:"monthEarth",ref:t},null,512),p("span",{title:"我有一个愿望",onClick:R,class:"iconfont absolute bottom-0 left-[50%] translate-x-[-50%] z-20 cursor-pointer text-[rgba(255,255,255,.5)] hover:text-[rgba(255,255,255,1)] holp-btn"},""),l.value?(y(),v("p",{key:0,class:B(["text-[16px] text-white absolute bottom-[20px] left-[50%] translate-x-[-50%] now-hope",d.value?"nowhope-active":""]),style:H({"--wh":x.value/2+"px"})},C(l.value),7)):$("",!0),p("span",{onClick:r,class:"iconfont absolute top-[5px] right-[5px] z-20 cursor-pointer close"},""),ut,F(K,{ref_key:"hope",ref:h,isMobile:b.value},{default:q(()=>[p("div",pt,[dt,(y(!0),v(N,null,V(u.value,(E,D)=>(y(),v("p",{onClick:mt=>W(E),class:"text-[16px] hover:bg-[rgba(255,255,255,1)] cursor-pointer w-[60%] text-center mb-[10px] py-[5px] bg-[rgba(255,255,255,.5)] rounded-[5px]",key:D},C(E),9,xt))),128))])]),_:1},8,["isMobile"])]))}},bt=I(gt,[["__scopeId","data-v-8ad6e9d7"]]);export{bt as default};
